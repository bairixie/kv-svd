==================================================
[RUN] Sat Feb 21 02:52:43 PM EST 2026 ds=ruler/niah_single_1 method=full_svd stage=acc CUDA_VISIBLE_DEVICES=0
LOG=experiments/logs_robust/20260221_132305_acc_LGS4_RK256_RV384_it8/logs/LGS4_RK256_RV384_it8__full_svd__ruler_niah_single_1.log
BENCH=experiments/logs_robust/20260221_132305_acc_LGS4_RK256_RV384_it8/bench/LGS4_RK256_RV384_it8__full_svd__ruler_niah_single_1.json
PROF_DIR=experiments/logs_robust/20260221_132305_acc_LGS4_RK256_RV384_it8/prof/LGS4_RK256_RV384_it8__full_svd__ruler_niah_single_1
[Dist init] world_size=1
data_names: ['ruler/niah_single_1']

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:04,  1.49s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.14s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.01s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.47it/s]
Loading checkpoint shards: 100%|██████████| 4/4 [00:03<00:00,  1.17it/s]
2026-02-21 14:52:54.410 | INFO     | utils:apply_kv_compress_patch:69 - Generating the kv compress configs
2026-02-21 14:52:54.410 | INFO     | utils:apply_kv_compress_patch:74 - Generating the default merge config (consecutive)
2026-02-21 14:52:54.410 | INFO     | utils:apply_kv_compress_patch:99 - compression config: xKVConfig(
  # Global params:
  num_layers=32,
  layer_merge_impl='svd',
  rank_k=256, rank_v=384,
  n_iter=8, oversample=4,
  slerp_t=0.5, slerp_gamma=0.05,
  merge_key=True, merge_value=True,
  # Quantizer params:
  kv_bits=16, group_size=0,
  sym=False, clip_ratio=1.0, hadamard=False,
  # 8 groups:
    [0] -> LayerGroup(layers=[0, 1, 2, 3], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
    [1] -> LayerGroup(layers=[4, 5, 6, 7], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
    [2] -> LayerGroup(layers=[8, 9, 10, 11], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
    [3] -> LayerGroup(layers=[12, 13, 14, 15], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
    [4] -> LayerGroup(layers=[16, 17, 18, 19], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
    [5] -> LayerGroup(layers=[20, 21, 22, 23], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
    [6] -> LayerGroup(layers=[24, 25, 26, 27], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
    [7] -> LayerGroup(layers=[28, 29, 30, 31], rank_k=256, rank_v=384, slerp_t=None, slerp_gamma=None)
)
2026-02-21 14:52:54.410 | INFO     | utils:apply_kv_compress_patch:100 - Applying the patch to the model
2026-02-21 14:52:54.411 | INFO     | xKV.patch:enable_xKV_patch:55 - Enabling xKV patch for model: ['LlamaForCausalLM']
Enabled xKV: True
SVD benchmark enabled: method=full_svd, output=experiments/logs_robust/20260221_132305_acc_LGS4_RK256_RV384_it8/bench/LGS4_RK256_RV384_it8__full_svd__ruler_niah_single_1.json
[Test] meta-llama/Meta-Llama-3.1-8B-Instruct on ruler/niah_single_1, results saved to temporary/Meta-Llama-3.1-8B-Instruct/ruler/niah_single_1_65536_xKV-4_k256_v384.jsonl

Testing:   0%|          | 0/96 [00:00<?, ?it/s]
Testing:   1%|          | 1/96 [01:33<2:27:43, 93.30s/it]
Testing:   1%|          | 1/96 [01:33<2:27:43, 93.30s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   2%|▏         | 2/96 [03:06<2:26:00, 93.19s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   2%|▏         | 2/96 [03:06<2:26:00, 93.19s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   3%|▎         | 3/96 [04:39<2:24:24, 93.17s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   3%|▎         | 3/96 [04:39<2:24:24, 93.17s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   4%|▍         | 4/96 [06:11<2:22:23, 92.87s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   4%|▍         | 4/96 [06:11<2:22:23, 92.87s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   5%|▌         | 5/96 [07:44<2:20:40, 92.75s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   5%|▌         | 5/96 [07:44<2:20:40, 92.75s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   6%|▋         | 6/96 [09:16<2:18:53, 92.59s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   6%|▋         | 6/96 [09:16<2:18:53, 92.59s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   7%|▋         | 7/96 [10:49<2:17:19, 92.58s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   7%|▋         | 7/96 [10:49<2:17:19, 92.58s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   8%|▊         | 8/96 [12:21<2:15:44, 92.56s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   8%|▊         | 8/96 [12:21<2:15:44, 92.56s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   9%|▉         | 9/96 [13:51<2:12:58, 91.71s/it, avg_score=1, max_memory (GB)=31.5]
Testing:   9%|▉         | 9/96 [13:51<2:12:58, 91.71s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  10%|█         | 10/96 [15:24<2:11:43, 91.90s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  10%|█         | 10/96 [15:24<2:11:43, 91.90s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  11%|█▏        | 11/96 [16:56<2:10:31, 92.13s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  11%|█▏        | 11/96 [16:56<2:10:31, 92.13s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  12%|█▎        | 12/96 [18:29<2:09:22, 92.41s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  12%|█▎        | 12/96 [18:29<2:09:22, 92.41s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  14%|█▎        | 13/96 [20:02<2:07:54, 92.46s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  14%|█▎        | 13/96 [20:02<2:07:54, 92.46s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  15%|█▍        | 14/96 [21:35<2:06:41, 92.70s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  15%|█▍        | 14/96 [21:35<2:06:41, 92.70s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  16%|█▌        | 15/96 [23:08<2:05:26, 92.92s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  16%|█▌        | 15/96 [23:08<2:05:26, 92.92s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  17%|█▋        | 16/96 [24:41<2:03:38, 92.73s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  17%|█▋        | 16/96 [24:41<2:03:38, 92.73s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  18%|█▊        | 17/96 [26:13<2:01:54, 92.58s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  18%|█▊        | 17/96 [26:13<2:01:54, 92.58s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  19%|█▉        | 18/96 [27:46<2:00:20, 92.57s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  19%|█▉        | 18/96 [27:46<2:00:20, 92.57s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  20%|█▉        | 19/96 [29:19<1:58:59, 92.72s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  20%|█▉        | 19/96 [29:19<1:58:59, 92.72s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  21%|██        | 20/96 [30:52<1:57:42, 92.92s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  21%|██        | 20/96 [30:52<1:57:42, 92.92s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  22%|██▏       | 21/96 [32:25<1:56:06, 92.88s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  22%|██▏       | 21/96 [32:25<1:56:06, 92.88s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  23%|██▎       | 22/96 [33:58<1:54:43, 93.02s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  23%|██▎       | 22/96 [33:58<1:54:43, 93.02s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  24%|██▍       | 23/96 [35:32<1:53:19, 93.14s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  24%|██▍       | 23/96 [35:32<1:53:19, 93.14s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  25%|██▌       | 24/96 [37:05<1:51:44, 93.12s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  25%|██▌       | 24/96 [37:05<1:51:44, 93.12s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  26%|██▌       | 25/96 [38:36<1:49:41, 92.69s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  26%|██▌       | 25/96 [38:36<1:49:41, 92.69s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  27%|██▋       | 26/96 [40:09<1:48:12, 92.75s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  27%|██▋       | 26/96 [40:09<1:48:12, 92.75s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  28%|██▊       | 27/96 [41:42<1:46:37, 92.72s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  28%|██▊       | 27/96 [41:42<1:46:37, 92.72s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  29%|██▉       | 28/96 [43:14<1:45:02, 92.68s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  29%|██▉       | 28/96 [43:14<1:45:02, 92.68s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  30%|███       | 29/96 [44:47<1:43:36, 92.78s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  30%|███       | 29/96 [44:47<1:43:36, 92.78s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  31%|███▏      | 30/96 [46:21<1:42:12, 92.92s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  31%|███▏      | 30/96 [46:21<1:42:12, 92.92s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  32%|███▏      | 31/96 [47:54<1:40:38, 92.90s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  32%|███▏      | 31/96 [47:54<1:40:38, 92.90s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  33%|███▎      | 32/96 [49:27<1:39:10, 92.98s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  33%|███▎      | 32/96 [49:27<1:39:10, 92.98s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  34%|███▍      | 33/96 [50:59<1:37:33, 92.91s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  34%|███▍      | 33/96 [50:59<1:37:33, 92.91s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  35%|███▌      | 34/96 [52:32<1:35:58, 92.88s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  35%|███▌      | 34/96 [52:32<1:35:58, 92.88s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  36%|███▋      | 35/96 [54:05<1:34:20, 92.79s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  36%|███▋      | 35/96 [54:05<1:34:20, 92.79s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  38%|███▊      | 36/96 [55:38<1:32:48, 92.80s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  38%|███▊      | 36/96 [55:38<1:32:48, 92.80s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  39%|███▊      | 37/96 [57:10<1:31:10, 92.71s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  39%|███▊      | 37/96 [57:10<1:31:10, 92.71s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  40%|███▉      | 38/96 [58:40<1:28:46, 91.84s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  40%|███▉      | 38/96 [58:40<1:28:46, 91.84s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  41%|████      | 39/96 [1:00:12<1:27:24, 92.01s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  41%|████      | 39/96 [1:00:12<1:27:24, 92.01s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  42%|████▏     | 40/96 [1:01:45<1:26:05, 92.23s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  42%|████▏     | 40/96 [1:01:45<1:26:05, 92.23s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  43%|████▎     | 41/96 [1:03:18<1:24:40, 92.38s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  43%|████▎     | 41/96 [1:03:18<1:24:40, 92.38s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  44%|████▍     | 42/96 [1:04:50<1:23:06, 92.34s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  44%|████▍     | 42/96 [1:04:50<1:23:06, 92.34s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  45%|████▍     | 43/96 [1:06:23<1:21:43, 92.52s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  45%|████▍     | 43/96 [1:06:23<1:21:43, 92.52s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  46%|████▌     | 44/96 [1:07:53<1:19:23, 91.60s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  46%|████▌     | 44/96 [1:07:53<1:19:23, 91.60s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  47%|████▋     | 45/96 [1:09:26<1:18:15, 92.06s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  47%|████▋     | 45/96 [1:09:26<1:18:15, 92.06s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  48%|████▊     | 46/96 [1:10:58<1:16:52, 92.26s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  48%|████▊     | 46/96 [1:10:58<1:16:52, 92.26s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  49%|████▉     | 47/96 [1:12:31<1:15:29, 92.44s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  49%|████▉     | 47/96 [1:12:31<1:15:29, 92.44s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  50%|█████     | 48/96 [1:14:04<1:14:01, 92.53s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  50%|█████     | 48/96 [1:14:04<1:14:01, 92.53s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  51%|█████     | 49/96 [1:15:37<1:12:33, 92.63s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  51%|█████     | 49/96 [1:15:37<1:12:33, 92.63s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  52%|█████▏    | 50/96 [1:17:10<1:11:05, 92.73s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  52%|█████▏    | 50/96 [1:17:10<1:11:05, 92.73s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  53%|█████▎    | 51/96 [1:18:43<1:09:38, 92.86s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  53%|█████▎    | 51/96 [1:18:43<1:09:38, 92.86s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  54%|█████▍    | 52/96 [1:20:16<1:08:07, 92.90s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  54%|█████▍    | 52/96 [1:20:16<1:08:07, 92.90s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  55%|█████▌    | 53/96 [1:21:49<1:06:31, 92.82s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  55%|█████▌    | 53/96 [1:21:49<1:06:31, 92.82s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  56%|█████▋    | 54/96 [1:23:19<1:04:21, 91.94s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  56%|█████▋    | 54/96 [1:23:19<1:04:21, 91.94s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  57%|█████▋    | 55/96 [1:24:52<1:03:06, 92.35s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  57%|█████▋    | 55/96 [1:24:52<1:03:06, 92.35s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  58%|█████▊    | 56/96 [1:26:25<1:01:40, 92.51s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  58%|█████▊    | 56/96 [1:26:25<1:01:40, 92.51s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  59%|█████▉    | 57/96 [1:27:58<1:00:19, 92.80s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  59%|█████▉    | 57/96 [1:27:58<1:00:19, 92.80s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  60%|██████    | 58/96 [1:29:31<58:44, 92.76s/it, avg_score=1, max_memory (GB)=31.5]  
Testing:  60%|██████    | 58/96 [1:29:31<58:44, 92.76s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  61%|██████▏   | 59/96 [1:31:04<57:19, 92.95s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  61%|██████▏   | 59/96 [1:31:04<57:19, 92.95s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  62%|██████▎   | 60/96 [1:32:37<55:48, 93.01s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  62%|██████▎   | 60/96 [1:32:37<55:48, 93.01s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  64%|██████▎   | 61/96 [1:34:11<54:19, 93.14s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  64%|██████▎   | 61/96 [1:34:11<54:19, 93.14s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  65%|██████▍   | 62/96 [1:35:44<52:45, 93.11s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  65%|██████▍   | 62/96 [1:35:44<52:45, 93.11s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  66%|██████▌   | 63/96 [1:37:16<51:05, 92.91s/it, avg_score=1, max_memory (GB)=31.5]
Testing:  66%|██████▌   | 63/96 [1:37:16<51:05, 92.91s/it, avg_score=0.984, max_memory (GB)=31.5]
Testing:  67%|██████▋   | 64/96 [1:38:49<49:35, 92.97s/it, avg_score=0.984, max_memory (GB)=31.5]
Testing:  67%|██████▋   | 64/96 [1:38:49<49:35, 92.97s/it, avg_score=0.984, max_memory (GB)=31.5]
Testing:  68%|██████▊   | 65/96 [1:40:22<48:00, 92.91s/it, avg_score=0.984, max_memory (GB)=31.5]
Testing:  68%|██████▊   | 65/96 [1:40:22<48:00, 92.91s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  69%|██████▉   | 66/96 [1:41:55<46:26, 92.88s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  69%|██████▉   | 66/96 [1:41:55<46:26, 92.88s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  70%|██████▉   | 67/96 [1:43:28<44:56, 92.97s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  70%|██████▉   | 67/96 [1:43:28<44:56, 92.97s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  71%|███████   | 68/96 [1:45:01<43:21, 92.92s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  71%|███████   | 68/96 [1:45:01<43:21, 92.92s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  72%|███████▏  | 69/96 [1:46:34<41:51, 93.01s/it, avg_score=0.985, max_memory (GB)=31.5]
Testing:  72%|███████▏  | 69/96 [1:46:34<41:51, 93.01s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  73%|███████▎  | 70/96 [1:48:06<40:09, 92.67s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  73%|███████▎  | 70/96 [1:48:06<40:09, 92.67s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  74%|███████▍  | 71/96 [1:49:39<38:35, 92.62s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  74%|███████▍  | 71/96 [1:49:39<38:35, 92.62s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  75%|███████▌  | 72/96 [1:51:12<37:05, 92.73s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  75%|███████▌  | 72/96 [1:51:12<37:05, 92.73s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  76%|███████▌  | 73/96 [1:52:44<35:31, 92.69s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  76%|███████▌  | 73/96 [1:52:44<35:31, 92.69s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  77%|███████▋  | 74/96 [1:54:17<34:00, 92.76s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  77%|███████▋  | 74/96 [1:54:17<34:00, 92.76s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  78%|███████▊  | 75/96 [1:55:50<32:30, 92.86s/it, avg_score=0.986, max_memory (GB)=31.5]
Testing:  78%|███████▊  | 75/96 [1:55:50<32:30, 92.86s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  79%|███████▉  | 76/96 [1:57:20<30:39, 91.99s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  79%|███████▉  | 76/96 [1:57:20<30:39, 91.99s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  80%|████████  | 77/96 [1:58:53<29:11, 92.19s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  80%|████████  | 77/96 [1:58:53<29:11, 92.19s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  81%|████████▏ | 78/96 [2:00:25<27:41, 92.32s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  81%|████████▏ | 78/96 [2:00:25<27:41, 92.32s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  82%|████████▏ | 79/96 [2:01:58<26:11, 92.46s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  82%|████████▏ | 79/96 [2:01:58<26:11, 92.46s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  83%|████████▎ | 80/96 [2:03:31<24:42, 92.67s/it, avg_score=0.987, max_memory (GB)=31.5]
Testing:  83%|████████▎ | 80/96 [2:03:31<24:42, 92.67s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  84%|████████▍ | 81/96 [2:05:04<23:11, 92.74s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  84%|████████▍ | 81/96 [2:05:04<23:11, 92.74s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  85%|████████▌ | 82/96 [2:06:36<21:33, 92.41s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  85%|████████▌ | 82/96 [2:06:36<21:33, 92.41s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  86%|████████▋ | 83/96 [2:08:09<20:03, 92.59s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  86%|████████▋ | 83/96 [2:08:09<20:03, 92.59s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  88%|████████▊ | 84/96 [2:09:39<18:22, 91.84s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  88%|████████▊ | 84/96 [2:09:39<18:22, 91.84s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  89%|████████▊ | 85/96 [2:11:09<16:44, 91.32s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  89%|████████▊ | 85/96 [2:11:09<16:44, 91.32s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  90%|████████▉ | 86/96 [2:12:42<15:18, 91.81s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  90%|████████▉ | 86/96 [2:12:42<15:18, 91.81s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  91%|█████████ | 87/96 [2:14:15<13:48, 92.07s/it, avg_score=0.988, max_memory (GB)=31.5]
Testing:  91%|█████████ | 87/96 [2:14:15<13:48, 92.07s/it, avg_score=0.989, max_memory (GB)=31.5]
Testing:  92%|█████████▏| 88/96 [2:15:48<12:18, 92.37s/it, avg_score=0.989, max_memory (GB)=31.5]
Testing:  92%|█████████▏| 88/96 [2:15:48<12:18, 92.37s/it, avg_score=0.989, max_memory (GB)=31.5]
Testing:  93%|█████████▎| 89/96 [2:17:21<10:48, 92.71s/it, avg_score=0.989, max_memory (GB)=31.5]
Testing:  93%|█████████▎| 89/96 [2:17:21<10:48, 92.71s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  94%|█████████▍| 90/96 [2:18:54<09:16, 92.83s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  94%|█████████▍| 90/96 [2:18:54<09:16, 92.83s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  95%|█████████▍| 91/96 [2:20:28<07:44, 92.94s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  95%|█████████▍| 91/96 [2:20:28<07:44, 92.94s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  96%|█████████▌| 92/96 [2:22:01<06:11, 92.92s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  96%|█████████▌| 92/96 [2:22:01<06:11, 92.92s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  97%|█████████▋| 93/96 [2:23:33<04:38, 92.85s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  97%|█████████▋| 93/96 [2:23:33<04:38, 92.85s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  98%|█████████▊| 94/96 [2:25:06<03:05, 92.85s/it, avg_score=0.989, max_memory (GB)=31.6]
Testing:  98%|█████████▊| 94/96 [2:25:06<03:05, 92.85s/it, avg_score=0.979, max_memory (GB)=31.6]
Testing:  99%|█████████▉| 95/96 [2:26:39<01:32, 92.90s/it, avg_score=0.979, max_memory (GB)=31.6]
Testing:  99%|█████████▉| 95/96 [2:26:39<01:32, 92.90s/it, avg_score=0.979, max_memory (GB)=31.6]
Testing: 100%|██████████| 96/96 [2:28:12<00:00, 93.03s/it, avg_score=0.979, max_memory (GB)=31.6]
Testing: 100%|██████████| 96/96 [2:28:12<00:00, 93.03s/it, avg_score=0.979, max_memory (GB)=31.6]
Testing: 100%|██████████| 96/96 [2:28:12<00:00, 92.63s/it, avg_score=0.979, max_memory (GB)=31.6]
Results for ruler/niah_single_1: {'model': 'meta-llama/Meta-Llama-3.1-8B-Instruct', 'dataset': 'ruler/niah_single_1', 'samples': 96, 'baseline': 0.9791666666666666}
SVD benchmark saved to experiments/logs_robust/20260221_132305_acc_LGS4_RK256_RV384_it8/bench/LGS4_RK256_RV384_it8__full_svd__ruler_niah_single_1.json
| model                                 | dataset             |   samples |   baseline |
|:--------------------------------------|:--------------------|----------:|-----------:|
| meta-llama/Meta-Llama-3.1-8B-Instruct | ruler/niah_single_1 |        96 |   0.979167 |
| mean                                  | mean                |        96 |   0.979167 |
[OK] LGS4_RK256_RV384_it8__full_svd__ruler_niah_single_1
