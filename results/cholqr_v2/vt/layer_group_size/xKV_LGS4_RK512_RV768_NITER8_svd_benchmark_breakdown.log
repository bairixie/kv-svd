================================================================================
SVD Algorithm Latency Breakdown Report (Simplified)
================================================================================

Algorithm Overview:
--------------------------------------------------------------------------------
Randomized SVD Algorithm Steps:
  1. Preparation: Reshape tensor, prepare transpose and identity matrix
  2. Projection: Random projection Y = X @ Omega (first BMM)
  3. Power Iteration: Iteratively refine Y using X^T @ Y and X @ Z (BMMs + QR)
  4. Final QR: Orthonormalize Y to get Q using Cholesky QR (fallback to Householder)
  5. Project to Low-rank: Compute B = Q^T @ X (BMM)
  6. Small SVD (FP32): Perform SVD on small matrix B
  7. Reconstruction: Reconstruct U = Q @ U_hat (BMM)

Configuration:
  SVD Method: randomized
  Use Original SVD: False
  Timestamp: 2026-02-10 02:24:43

================================================================================
Method: Custom Randomized SVD (Rank 512)
Rank: 512
================================================================================
Total Calls: 768
Total Time: 163608.93 ms (163.61 s)
Average Time: 213.03 ms
Min/Max Time: 195.61 / 275.24 ms

Latency Breakdown (Average per call):
--------------------------------------------------------------------------------
1. Preparation                               :     2.38 ms (min:   2.35, max:   2.47) (  1.1%)
  Reshape tensor, prepare transpose and identity matrix
2. Projection (BMM)                          :     3.21 ms (min:   3.11, max:   4.45) (  1.5%)
  Random projection Y = X @ Omega
3. Power Iteration (Total)                   :   161.54 ms (min: 148.14, max: 216.83) ( 75.8%)
  Iteratively refine Y: X^T @ Y and X @ Z (includes all BMMs and QR)
4. Final QR                                  :     8.50 ms (min:   8.14, max:   8.76) (  4.0%)
  Orthonormalize Y to get Q (Cholesky QR or Householder fallback)
5. Project to Low-rank (BMM)                 :     4.09 ms (min:   2.52, max:   4.55) (  1.9%)
  Compute B = Q^T @ X
6. Small SVD (FP32)                          :    32.02 ms (min:  28.93, max:  37.82) ( 15.0%)
  Perform SVD on small matrix B
7. Reconstruction (BMM)                      :     0.65 ms (min:   0.50, max:   0.72) (  0.3%)
  Reconstruct U = Q @ U_hat

Time Sum Verification:
--------------------------------------------------------------------------------
  Sum of 7 main stages:   212.38 ms
  Total measured time:    213.03 ms
  Difference:                0.65 ms (0.31%)
  ✓ Time sum verification passed (difference < 1%)

Sample Record Details:
--------------------------------------------------------------------------------
Tensor Shape: [1, 32, 65295, 128]
Rank: 512
Power Iterations (n_iter): 8
Oversample: 4

Breakdown (one sample):
  1. Preparation: 2.38 ms
  2. Projection (BMM): 4.45 ms
  3. Power Iteration (Total): 216.83 ms
  4. Final QR: 8.32 ms
  5. Project to Low-rank (BMM): 4.48 ms
  6. Small SVD (FP32): 37.82 ms
  7. Reconstruction (BMM): 0.70 ms

================================================================================
Method: Custom Randomized SVD (Rank 768)
Rank: 768
================================================================================
Total Calls: 768
Total Time: 240143.34 ms (240.14 s)
Average Time: 312.69 ms
Min/Max Time: 285.04 / 343.60 ms

Latency Breakdown (Average per call):
--------------------------------------------------------------------------------
1. Preparation                               :     2.36 ms (min:   2.35, max:   2.37) (  0.8%)
  Reshape tensor, prepare transpose and identity matrix
2. Projection (BMM)                          :     4.03 ms (min:   3.95, max:   4.15) (  1.3%)
  Random projection Y = X @ Omega
3. Power Iteration (Total)                   :   236.99 ms (min: 216.40, max: 252.37) ( 75.8%)
  Iteratively refine Y: X^T @ Y and X @ Z (includes all BMMs and QR)
4. Final QR                                  :    15.09 ms (min:  14.44, max:  15.70) (  4.8%)
  Orthonormalize Y to get Q (Cholesky QR or Householder fallback)
5. Project to Low-rank (BMM)                 :     5.66 ms (min:   3.46, max:   6.46) (  1.8%)
  Compute B = Q^T @ X
6. Small SVD (FP32)                          :    47.30 ms (min:  41.51, max:  65.40) ( 15.1%)
  Perform SVD on small matrix B
7. Reconstruction (BMM)                      :     1.14 ms (min:   0.82, max:   1.29) (  0.4%)
  Reconstruct U = Q @ U_hat

Time Sum Verification:
--------------------------------------------------------------------------------
  Sum of 7 main stages:   312.56 ms
  Total measured time:    312.69 ms
  Difference:                0.12 ms (0.04%)
  ✓ Time sum verification passed (difference < 1%)

Sample Record Details:
--------------------------------------------------------------------------------
Tensor Shape: [1, 32, 65295, 128]
Rank: 768
Power Iterations (n_iter): 8
Oversample: 4

Breakdown (one sample):
  1. Preparation: 2.36 ms
  2. Projection (BMM): 4.06 ms
  3. Power Iteration (Total): 245.07 ms
  4. Final QR: 15.05 ms
  5. Project to Low-rank (BMM): 6.19 ms
  6. Small SVD (FP32): 61.36 ms
  7. Reconstruction (BMM): 1.23 ms

================================================================================
End of Report
================================================================================
